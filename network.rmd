---
title: "Mutual Information Networks of the H3N2 Polymerase"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(associationsubgraphs)
```

<br/>
<br/>

Network visualizations generated using the [associationsubgraphs](https://github.com/nstrayer/associationsubgraphs) package by Nick Strayer.

---


# H3N2 Polymerase

```{r echo = FALSE, message = FALSE, warning = FALSE}
mi_network_info <- readRDS("/Users/sarcos/Desktop/Lauring Lab/timeMI/data/mi_network_info.rds")
mip_noHA<- readRDS("/Users/sarcos/Desktop/Lauring Lab/timeMI/data/h3n2pol_equalMI.rds") %>%
  left_join(mi_network_info, by = c("V1" = "index")) %>%
  left_join(mi_network_info, by = c("V2" = "index")) %>%
  select(a = "id.x", b = "id.y", strength = mip) %>%
  slice_max(strength, n = 2232/2)

sub_structure_noHA <- mip_noHA %>%
  calculate_subgraph_structure()

visualize_subgraph_structure(
  association_pairs = mip_noHA,
  node_info = mi_network_info %>% select(-index),
  subgraph_results = sub_structure_noHA,
  trim_subgraph_results = FALSE,
  default_step = "min_max_rule"
)
```


<br/>
<br/>

---

<br/>
<br/>

# H3N2 Polymerase with HA

```{r echo = FALSE, message = FALSE, warning = FALSE}
mi <- readRDS("/Users/sarcos/Desktop/Lauring Lab/timeMI/data/h3n2polHA_equalMI.rds") %>%
  select(V1, V2, mip) %>%
  left_join(mi_network_info, by = c("V1" = "index")) %>%
  left_join(mi_network_info, by = c("V2" = "index")) %>%
  select(a = "id.x", b = "id.y", strength = mip) %>%
  slice_max(strength, n = 2798/2)

sub_structure <- mi %>%
  calculate_subgraph_structure()

visualize_subgraph_structure(
  association_pairs = mi,
  node_info = mi_network_info %>% select(-index),
  subgraph_results = sub_structure,
  trim_subgraph_results = FALSE,
  default_step = "min_max_rule"
)
```
